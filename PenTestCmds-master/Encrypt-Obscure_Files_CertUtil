Deobfuscate/Decode Files Or Information
Encode/Decode executable Upon execution a file named T1140_calc_decoded.exe will be placed in the temp folder

Supported Platforms: Windows

Inputs:
Name	Description	Type	Default Value
executable	name of executable	path	C:\Windows\System32\calc.exe
Attack Commands: Run with command_prompt!
certutil -encode #{executable} %temp%\T1140_calc.txt
certutil -decode %temp%\T1140_calc.txt %temp%\T1140_calc_decoded.exe
Cleanup Commands:
  del %temp%\T1140_calc.txt >nul 2>&1
  del %temp%\T1140_calc_decoded.exe >nul 2>&1


Atomic Test #2 - Certutil Rename and Decode
Rename certutil and decode a file. This is in reference to latest research by FireEye here

Supported Platforms: Windows

Inputs:
Name	Description	Type	Default Value
executable	name of executable/file to decode	path	C:\Windows\System32\calc.exe
Attack Commands: Run with command_prompt!
copy %windir%\system32\certutil.exe %temp%\tcm.tmp
%temp%\tcm.tmp -encode #{executable} %temp%\T1140_calc2.txt
%temp%\tcm.tmp -decode %temp%\T1140_calc2.txt %temp%\T1140_calc2_decoded.exe
Cleanup Commands:
  del %temp%\tcm.tmp >nul 2>&1
  del %temp%\T1140_calc2.txt >nul 2>&1
  del %temp%\T1140_calc2_decoded.exe >nul 2>&1
